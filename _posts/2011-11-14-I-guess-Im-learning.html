---
layout: post
title: I guess I'm learning, a python script is easier than using formulas in a spreadsheet!
tags: 2011, Betwixt, Programming,
---

<div style="background-color: transparent;"><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">This past Friday I analyzed our voting data from the Kickstarter naming poll. &nbsp;I used to interact with Excel a ton, but when I started looking at the results from the googledocs spreadsheet I realized that I could just as easily (if not more so), get the information I needed by creating a small python script. &nbsp;So I cut and pasted the three things I needed into text (.txt) files and got to it.</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">&nbsp;</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">There were five main things I needed to accomplish, before I could analyze my data. &nbsp;</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: bold; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">First I needed to create some text files for my data.</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;I needed three text files. &nbsp;The first one was a list of all the acceptable &lsquo;unique-identifiers&rsquo;. &nbsp;These &lsquo;unique-identifiers&rsquo; were a tool we used to verify that those who voted were eligible to do so. &nbsp;They were automatically inputted into the form once the &lsquo;voter&rsquo; reached the link provided. &nbsp;Robey had created a list of such identifiers before and sent them out to all participating voters. &nbsp;The next text file was a list of all the &lsquo;unique-identifiers&rsquo; that our googledocs form received. &nbsp;I simply copy-pasted them into a file and saved it as text. &nbsp;The final text file was a list of all of the names voted for. &nbsp;Each &lsquo;voter&rsquo; was allowed to select more than one name, and so I was able to copy paste my column, but afterwards I had to go back through and set it up so that there was only one name per line, and that each line had no spaces at the beginning or end (so that none of the names were mistakenly counted). &nbsp;</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">&nbsp;</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Once I had all of these text files complete, I started writing my python script. &nbsp;</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: bold; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Secondly I identified the text files as variables in my code.</span></div>
<div style="background-color: transparent;"><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: bold; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><br /></span></div>
<div style="background-color: transparent;">
<div dir="ltr">
<table style="border-collapse: collapse; border: initial none initial;">
<colgroup><col width="323"></col></colgroup> 
<tbody>
<tr style="height: 0px;">
<td style="vertical-align: top; padding: 7px; border: 1px dotted #aaaaaa;"><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">tokens_FILENAME = "tokens.txt"</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">usedtokens_FILENAME = "usedtokens.txt"</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">kickstarterpoll_FILENAME = "kickstarterpoll.txt"</span></td>
</tr>
</tbody>
</table>
</div>
<div style="background-color: transparent;"><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">&nbsp;</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: bold; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Next I borrowed a little function from my MIT Programming course to interpret the file and make it into usable data.</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;Each text file was interpreted the same way. &nbsp;As an example, here is one of my functions:</span></div>
<div style="background-color: transparent;"><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><br /></span></div>
<div dir="ltr">
<table style="border-collapse: collapse; border: initial none initial;">
<colgroup><col width="294"></col></colgroup> 
<tbody>
<tr style="height: 0px;">
<td style="vertical-align: top; padding: 7px; border: 1px dotted #aaaaaa;"><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">def load_tokens():</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;print "Loading token list from file..."</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;# inFile: file</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;inFile = open(tokens_FILENAME, 'r', 0)</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;# wordlist: list of strings</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;wordlist = []</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;for line in inFile:</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wordlist.append(line.strip().lower())</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;print " &nbsp;", len(wordlist), "words loaded."</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;return wordlist</span></td>
</tr>
</tbody>
</table>
</div>
<span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">&nbsp;</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">The function returns a list of valid tokens. Each token in the list is a string of lowercase letters. &nbsp;&nbsp;&nbsp;&nbsp;These lists helped me to analyze my data. &nbsp;Before I could use them, however, I had to run the functions so that I can get the results I need. &nbsp;Thus I created new variables, that are simply representations of the results of the functions.</span><br /><br />
<div dir="ltr">
<table style="border-collapse: collapse; border: initial none initial;">
<colgroup><col width="244"></col></colgroup> 
<tbody>
<tr style="height: 0px;">
<td style="vertical-align: top; padding: 7px; border: 1px dotted #aaaaaa;"><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">tokenlist = load_tokens()</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">usedtokenlist = load_usedtokens()</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">pollresults = load_kickstarterpoll()</span></td>
</tr>
</tbody>
</table>
</div>
<br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">The two tasks I needed to complete were to</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: bold; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> verify that all &lsquo;unique identifiers&rsquo; (in my code I call them tokens) submitted in the googledocs form were valid ones</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> that Robey sent out to the &lsquo;voters&rsquo;. &nbsp;The last and most important task was to </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: bold; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">count the resultant names submitted and find the winning one.</span><br /><br /><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: bold; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">Up Next Time: My final two functions and the winning name from our Kickstarter poll.</span><br /><br /></div>
<p>&nbsp;</p>