---
layout: post
title: Connecting the final pieces and returning the csv data 
tags: 
 - 2012
 - Programming
 - CSP Schedule Converter
---

<p>&nbsp;</p>
<div style="background-color: transparent;"><strong id="internal-source-marker_0.20508663239888847"><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">The final steps needed to create the csv data for my </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">createcsv()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> function are the following. &nbsp;Set the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">subject</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> variable, consisting of the team name and the tshirt color (aka if the team is home or away that game). &nbsp;Second, setting the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">description</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> variable, including the current </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">game</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> number of the season and whom the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">competitor</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> is. &nbsp;Then identify if this event is an &ldquo;all day&rdquo; event that many calendars include. &nbsp;This data is to be input as either </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; font-style: italic; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">true</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> or </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; font-style: italic; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">false</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">, which is here entered as </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; font-style: italic; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">false</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">. &nbsp;</span><br /><br /> </strong>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">function createcsv (schedule){</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> //Other needed strings</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var subject = schedule[i].teamname + " " + schedule[i].tshirtcolor;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var description = "Game #" + schedule[i].game + " vs " + schedule[i].competitor;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var alldayevent = "False";</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var location = "Corvallis Sports Park";</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var pprivate = "True"</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var newcsventry = subject + "," + startdate + "," + starttime + "," + enddate + "," + endtime + "," + alldayevent + "," + description + "," + location + "," + pprivate + "\r\n";</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;finalcsv += newcsventry;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">}</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">return finalcsv</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">};</span></p>
<br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Next a variable is made called </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">location</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> which is simply a string, &ldquo;Corvallis Sports Park&rdquo;. &nbsp;Then </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">pprivate</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> is identified as </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; font-style: italic; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">true</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> so that the event will show up on your calendar automatically as a private event. &nbsp;The last part of setting up the CSV file is to concatenate all of these parts, following the original example shown here on the </span><a href="http://support.google.com/calendar/bin/answer.py?hl=en&amp;answer=45656"><span style="font-size: 15px; font-family: Arial; color: #1155cc; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">Google Help Forum</span></a><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">, and add it to the final list. &nbsp;Please note that the last bits added to this string is &lsquo;\r\n&rsquo; to make sure that the &lsquo;feed line&rsquo; and &lsquo;cartridge return&rsquo; (read: hitting the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">enter</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> button) occurs. &nbsp;Once the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">for</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> loop has finished processing, it will return a long string called </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">finalcsv</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">. &nbsp;</span><br /><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">Up Next Time: Issues and edits of code thus far</span></div>
<p>&nbsp;</p>