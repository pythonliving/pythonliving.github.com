---
layout: post
title: Creating an ics file, continued 
tags: 
 - 2012
 - Programming
 - CSP Schedule Converter
---

<p>&nbsp;</p>
<div style="background-color: transparent;"><strong id="internal-source-marker_0.35852765291929245"><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Continuing on from my last entry...the first thing I do in this section of the code is set the time. &nbsp;I do that by using my </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">lessthanten()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> function and calling the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">schedule</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> variable as I did last time. &nbsp;I use this method to create the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">hour</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">, </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">minutes</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">, and </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">seconds</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> variables. &nbsp;Then I create </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">newtime</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> which is simply the end time of the soccer game. &nbsp;To do that I add 3,000,000 milliseconds, basically 50 minutes, which I then adjust with </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Date()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> to change my time in milliseconds to something more manageable.</span><br /><br /> </strong>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">function createics (schedule) { </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">&hellip;.</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;</span><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">//setting time</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var hour = lessthanten(schedule[i].datetime.getHours());</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var minutes = lessthanten(schedule[i].datetime.getMinutes());</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var seconds = lessthanten(schedule[i].datetime.getSeconds());</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var newtime = schedule[i].datetime.getTime() + (50*60*1000);</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;newtime = new Date(newtime);</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var endhour = lessthanten(newtime.getHours());</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var endminutes = lessthanten(newtime.getMinutes());</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var dtstart = "DTSTART:" + basicdate + "T" + hour + minutes + seconds;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;var dtend = "DTEND:" + basicdate + "T" + endhour + endminutes + seconds;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;...//Other strings</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;}</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> finalics += "END:VCALENDAR";</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> return finalics</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">};</span></p>
<br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Then I set the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">endhour</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> and </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">endminutes</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">. &nbsp;Like with the date (discussed in my last entry), I simply concatenate the items together to get my </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">DTSTART</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> and </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">DTEND</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> times. &nbsp;This is a basic abbreviation where </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">DTSTART</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> is date/time start and respectively </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">DTEND</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> is date/time end. &nbsp;The format for date and time entry for ics files is the date, followed by a T to indicate time and then the time. &nbsp;So I grab my </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">basicdate</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> that created last entry, tack it on to the beginning of these variables, input a </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">T</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> for time, and then concatenate the rest of the information on the end.</span><br /><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">Up Next Time: End of ics file creation</span></div>
<p>&nbsp;</p>