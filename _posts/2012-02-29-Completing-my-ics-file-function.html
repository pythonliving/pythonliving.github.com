---
layout: post
title: Completing my ics file function
tags: 
 - 2012
 - Programming
 - CSP Schedule Converter
---

<p><strong id="internal-source-marker_0.9671740070916712" style="font-family: 'Times New Roman'; font-size: medium;"><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">Today I&rsquo;ve returned to my explanation of the CSP Schedule Converter extension. &nbsp;At the very end of the function the rest of the parts are identified and the information is concatenated into the end resulting ics file. &nbsp;</span><br /><br /><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">function createics (schedule) { </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">&hellip;.</span><br /> </strong></p>
<p style="text-indent: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><strong id="internal-source-marker_0.9671740070916712" style="font-family: 'Times New Roman'; font-size: medium;"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var begin = "BEGIN:VEVENT";</span></strong></p>
<p><strong id="internal-source-marker_0.9671740070916712" style="font-family: 'Times New Roman'; font-size: medium;">
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var end = "END:VEVENT";</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var summary = "SUMMARY:" + schedule[i].teamname + " " + schedule[i].tshirtcolor;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var description = "DESCRIPTION:" + "Game #" + schedule[i].game + " vs " + schedule[i].competitor;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var pprivate = "CLASS:PRIVATE";</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var icsevent = begin + "\n" + summary + "\n" + description + "\n" + dtstamp + "\n" + dtstart + "\n" + dtend + &nbsp;&nbsp;"\n" + pprivate + "\n" + end + "\n";</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;finalics += icsevent; &nbsp;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;}</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">finalics += "END:VCALENDAR";</span></p>
<h6 style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 13px; font-family: Arial; color: #666666; background-color: transparent; font-weight: normal; font-style: italic; vertical-align: baseline; white-space: pre-wrap;">return finalics</span></h6>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">};</span></p>
<br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">As mentioned previously, ics and csv files need to be formatted a particular way in order to be imported correctly as calendar files. &nbsp;To start an ics file event entry you input this text: BEGIN:VEVENT. &nbsp;Subsequently END:VEVENT identifies the end of an event entry in an ics file. &nbsp;I&rsquo;ve created these for each entry, and labeled them as </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">begin</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> and </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">end</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> variables. &nbsp;Then I create a variable called </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">summary</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> which includes the team name and whether or not you&rsquo;re home or away for that game. &nbsp;The </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">description</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> variable includes the game number of the season, game and the competitor. &nbsp;</span><br /><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">As with the csv file, use </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">pprivate</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> to identify that the event is classified as private unless the particular user wishes to adjust it otherwise. &nbsp;Then to complete it I concatenate it all together into a singular </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">icsevent</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> variable. &nbsp;As I go through each event on the page an ics version is created and added to the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">finalics</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> list. &nbsp;To complete the entire ics file, the string &ldquo;END:VCALENDAR&rdquo; is added. &nbsp;The variable </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">finalics</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> is then returned from the function </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">createics()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">.</span><br /><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">Up Next Time: Using jQuery to create an interface for my extension</span><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;"> </span></strong></p>
<p>&nbsp;</p>