---
layout: post
title: Setting the start date and time of my calendar event in CSV format
tags: 
 - 2012
 - Programming
 - CSP Schedule Converter
---

<p>&nbsp;</p>
<div style="background-color: transparent;"><strong id="internal-source-marker_0.7602943168021739"><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Now that most of the minor functions, and other details have been explained I can show how my function extracts the necessary data from the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">schedule</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> list of dictionaries. &nbsp;The first section I will explain is the setting of the current start date and time. &nbsp;To begin with I set three variables; </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">ampm</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">, </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">endampm</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">, and </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">month</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">. &nbsp;The first two are simply empty strings to be adjusted later on in the code. &nbsp;The last uses the </span><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/getMonth"><span style="font-size: 15px; font-family: Arial; color: #1155cc; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">getMonth()</span></a><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> method. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br /><br /> </strong>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">function createcsv (schedule){</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; font-style: italic; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;</span><a href="http://betterlivingthroughpython.posterous.com/creating-a-csv-calendar-file-with-javascript"><span style="font-size: 12px; font-family: Arial; color: #1155cc; background-color: transparent; font-weight: normal; font-style: italic; vertical-align: baseline; white-space: pre-wrap;">...see former entry regarding this section</span></a></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;//adjusting time from dictionary 'schedule'</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;//setting date</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var ampm = "";</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var endampm = "";</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var month = schedule[i].datetime.getMonth() + 1;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;month = lessthanten(month);</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var date = schedule[i].datetime.getDate();</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;date = lessthanten(date);</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var year = schedule[i].datetime.getFullYear().toString();</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;year = year.slice(2);</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var startdate = month + "/" + date + "/" + year;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var enddate = startdate;</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;var hour = schedule[i].datetime.getHours();</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;hourampm= adjusthour(hour);</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;hour = lessthanten(hourampm[0]);</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; font-style: italic; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;&nbsp;&nbsp;&hellip;continuing with endtime, and other code bits</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;}</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> &nbsp;return finalcsv</span></p>
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">};</span></p>
<br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">The getMonth() method, explained on the </span><a href="https://developer.mozilla.org/en-US/"><span style="font-size: 15px; font-family: Arial; color: #1155cc; background-color: transparent; font-weight: normal; vertical-align: baseline; white-space: pre-wrap;">Mozilla Developer Network</span></a><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">, will extract the month listed in the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">datetime</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> variable listed in the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">schedule</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> function. &nbsp;I access this piece of information by first identifying the location (schedule[i]), then the variable in that dictionary (datetime.), and then I apply the method and add 1 to the ending result. &nbsp;Adding one to the end result is done because the months are returned from the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">getMonth()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> method from 0 to 11, with 0 equaling January. &nbsp;After the month is extracted it&rsquo;s then adjusted with the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">lessthanten()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> function explained in my last entry (</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">Some simple functions to adjust my time formatting</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">). &nbsp;</span><br /><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">After the month is set, I go through mostly the same process for the date and year information. &nbsp;In the end I use the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">getMonth()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">, </span><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/getDate"><span style="font-size: 15px; font-family: Arial; color: #1155cc; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">getDate()</span></a><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">, and </span><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/getFullYear"><span style="font-size: 15px; font-family: Arial; color: #1155cc; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">getFullYear()</span></a><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> methods. &nbsp;The first two methods are processed in almost the same way, however the year must be altered slightly. &nbsp;The </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">year</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> variable, once collected, is 4 digits long. &nbsp;For CSV formatting I need the year to only be listed as the last two digits. &nbsp;To change my </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">year</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> variable to the last two digits, I need to slice it. &nbsp;To make that adjustment to my variable I first change the year from an integer to a string using </span><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/toString"><span style="font-size: 15px; font-family: Arial; color: #1155cc; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">toString()</span></a><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">. &nbsp;I must do this because you can&rsquo;t slice an integer without first making it a string. &nbsp;Then I slice my variable with this piece of code:</span><br /><br />
<p style="margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;" dir="ltr"><span style="font-size: 12px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">year = year.slice(2);</span></p>
<br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Once the year has been adjusted I combine all of my date variables into the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">startdate</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> variable, which creates a date format of: 01/01/12. &nbsp;Now I have to set the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">starttime</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> of my soccer game. &nbsp;To do this I use the </span><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/getHours"><span style="font-size: 15px; font-family: Arial; color: #1155cc; background-color: transparent; vertical-align: baseline; white-space: pre-wrap;">getHours()</span></a><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> method, which operates like the other </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">get()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> methods listed above. &nbsp;Then I adjust the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">hour</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> variable with the </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">adjusthour()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> and </span><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">lessthanten()</span><span style="font-size: 15px; font-family: Arial; background-color: transparent; font-weight: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> functions. &nbsp;In the next entry I&rsquo;ll be discussing the adjustments necessary to create the end time needed for csv calendar formatting.</span><br /><br /><span style="font-size: 15px; font-family: Arial; background-color: transparent; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">Up Next Time: Adjusting and setting the end date and time for CSV format</span></div>
<p>&nbsp;</p>